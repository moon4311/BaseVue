<!-- http://localhost:8001/#/list/basic-list -->

<template>
  <n-card>
    <div class="n-layout-page-header">
      <n-h3>사용자 정보</n-h3>
      <p>사용자 기본 정보</p>
    </div>
  </n-card>
      <div class="mt-4">
          <!-- Inputs -->
          <div class="flex items-center px-4 py-4 space-x-4 overflow-x-auto bg-white rounded-md">
            <div class="relative mx-4 lg:mx-0">
              <n-form inline>
                <n-form-item label="사용자명" path="searchValue">
                  <n-input v-model:value="searchValue" type="text" placeholder="Search" />
                </n-form-item>
                <n-form-item>
                  <n-button @click="search">
                    Search
                  </n-button>
                </n-form-item>
              </n-form>
            </div>
          </div>
        <!-- Table -->
        <div class="flex flex-col mt-6">
          <n-button type="info" @click="util.add">
              등록
            </n-button>
          <div class="py-2 -my-2 overflow-x-auto sm:-mx-6 sm:px-6 lg:-mx-8 lg:px-8" >
            <div class="inline-block min-w-full overflow-hidden align-middle border-b border-gray-200 shadow sm:rounded-lg" >
              <n-data-table
                :columns="columns"
                :data="userList"
                :bordered="false"
              />
            </div>
          </div>
        </div>
      </div>
</template>

<script lang="ts">
import { defineComponent, ref, h, onMounted } from "vue";
import axios from 'axios'
import * as util from '/src/assets/util';
import apiUrl from '/src/assets/base';
import { useRouter } from "vue-router";
import { NButton, useMessage } from "naive-ui";

export default defineComponent({
  setup() {
    util.setRouter(useRouter());
    const searchValue = ref("");
    const columns = [
                      {
                        title: "ID",
                        key: "userId"
                      },
                      {
                        title: "이름",
                        key: "userNm"
                      },
                      {
                        title: "연락처",
                        key: "tel"
                      },
                      {
                        title: "",
                        key: "userId",
                        render(row) {
                          return h(
                            NButton,
                            {
                              strong: true,
                              tertiary: false,
                              size: "small",
                              onClick: () => util.showInfo(row.userNo)
                            },
                            { default: () => "Edit" }
                          );
                        }
                      }
                    ];
    const userList = ref([]);
    //검색
    const search = ()=>{
      axios.get(apiUrl + "/user/list",{params:{ userNm : searchValue.value}}).then((res: any)=>{
        userList.value = res.data.data;
      });
    }

    onMounted(()=>{
      search();
    });
    
    return {
      searchValue,
      search,
      util,
      columns,
      userList
    };
  },
});
</script>